"""
MetPX Copyright (C) 2004-2006  Environment Canada
MetPX comes with ABSOLUTELY NO WARRANTY; For details type see the file 
named COPYING in the root of the source directory tree.
"""
##################################################################################################
# Name          : Stats monitoring documentation.                                                      
#                                                       
# Author        : Nicholas Lemay
# Last Update   : November 3rd 2006
#
###################################################################################################


About
---------------------
This utility was created as as to limit user interaction with the library
to the bare minimum. Therefore it monitors most of the vital
aspects of the library so that the user does not have to. Monitoring 
is to be made on a frequent interval and results are mailed to the 
library's administrator. Actions can then be taken to correct the errors
using the utilities found in the library.    


What's monitored
----------------------
Disk usage : Disk usage is monitored for each of the folders
             in wich the library writes data. A warning will be raised 
             if disk usage % goes over the amount specified in the config file.  

	     
Missing pickle files : Machines are supposed to keep the pickle files for at least 
                       x number of days. The stats monitor thus checks if the pickles for the 
		               clients/sources of all the specified machines  are all present for the
		               past x days. If fiels are absent a warning will be written in the report.
		       
Data gap             : Verifies all the pickle files to see if any data gaps deemed too wide are found. 
                       If the gap between two transmissions has been logged in the Columbo interface it will 
		               be considered normal and will be discarted. Otherwise a warning in the report
		               will be added describing the anomaly found.
		       
Stats log files      : Log files produced during the hourly activities of the stats library are monitored to see if 
                       activity has occured every hour. If more than an hour has gone by without any activity occuring, 
		               it will be reported.		        
		   
Library files        : Checksums will be run at every monitoring job and the current checksum will be compared to the 
                       previous checksum. If the checksum for a file within the library has been modified it will be reported. 
                       This is done in case a newer or older version of a file is being installed and that it is not compatible 
                       with the current version of the library.
		                    
Crontab entries      : This saves the current crontab listing every time a monitoring job is made. If current crontab 
                        listing is different than the previous crontab a warning will be added to the report.

WebPages             : Checks if the web pages have been updated at the right interval. Adds a warning to the report if 
                       webpages seem outdated.
   

Configuring the stats library monitor
---------------------------------------
Open the /apps/px/stats/statsMonitoring/statsMonitoring.conf configuration file.
Follow instructions.
 
Here is an example of a config file currently being used on a machine named logan1

#######################################################################################
##
## MetPX Copyright (C) 2004-2006  Environment Canada
## MetPX comes with ABSOLUTELY NO WARRANTY; For details type see the file
## named COPYING in the root of the source directory tree.
##
##
## Name   : statsMonitoring.conf
##  
## Author : Nicholas Lemay  
##
## Date   : December 1st 2006
##
## Goal   : This config file is to be read by statsMonitoring.py from the stats library.    
##
##          config file must contain only valid parameters or else statsMonitoring will
##          not work.
##
## Usage  : When using a list of parameters, parameters must be seperated by the ';' 
##          character. When a single parameter is a list in itself, seperate items  
##          with the ',' character. Paths need to be absolute path names.
##
##
## Parameters: emails : Speficies the recipients to wich the results of the monitoring 
##                       will be forwarded          
##
##             machines : Specifies the machines for wich this machine is currently 
##                        producing graphics for. If paired data is used (ex machine1,machine2)
##                        machines must be seperated with the , character 
##                        Ex pds5,pds6;pxatx
##
##             files    : List of files used by the stats library. statsMonitoring
##                        monitors the version fo these files and warns user if they 
##                        were changed since the last monitoring job occured. 
##
##             folders  : List of all folders used by the stats library. statsMonitoring 
##                        will monitor disk usage for all these folder to make sure 
##                        they do not go over a specified limit. If it does report sent to 
##                        user will have a mention of excessive disk usage.
##              
##             maxusage:  Specifies the maximum disk usage allowed for each of the 
##                        specified folders. Important note : The number of arameters used
##                        here must be the exact same number of parameters used in the
##                        folders parameters.  
##
##             errorsLogFile : Specify where the log file containing all the detected
##                             px errors were detected in the columbo interface.
##
##             maxSettingsFile : Specify where the config file containing the maximum 
##                               timer values are set. 
##             
##
##
##
#######################################################################################

[statsMonitoring]
emails   = nicholas.lemay@ec.gc.ca
machines = pds5,pds6;pxatx
files    = /apps/px/lib/stats/;/apps/px/lib/
folders  = /apps/px/lib/stats;/apps/px/stats/pickles/;/apps/px/stats/databases/;/apps/px/stats/databases_backups/; /apps/px/stats/graphs/;/apps/px/stats/log
maxUsages = 70;70;70;70;70;70
errorsLogFile=/apps/px/stats/statsMonitoring/PX_Errors.txt
maxSettingsFile=/apps/px/stats/maxSettings.conf






